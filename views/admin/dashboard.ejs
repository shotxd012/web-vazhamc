<%- include('../partials/head') %>
<%- include('../partials/message') %>

<body class="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white">
    <%- include('../partials/nav') %>

    <main class="container mx-auto px-4 pt-24 pb-16">
        <!-- Admin Dashboard Header -->
        <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-8 mb-8 border border-gray-700/50 shadow-xl mt-16">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-white mb-2">Admin Dashboard</h1>
                    <p class="text-gray-400">Welcome back, <%= user.username %></p>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="px-4 py-2 bg-emerald-500/10 text-emerald-400 rounded-full text-sm font-medium">
                        <i class="ph ph-shield-check mr-2"></i>Staff Member
                    </span>
                </div>
            </div>
        </div>

        <!-- User Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <!-- Total Members -->
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50">
                <h3 class="text-lg font-semibold text-white mb-4">Total Members</h3>
                <div class="relative h-48 flex items-center justify-center">
                    <canvas id="userMeterChart"></canvas>
                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center">
                        <p class="text-3xl font-bold text-white"><%= discordStats.totalMembers %></p>
                        <p class="text-sm text-gray-400">Discord Members</p>
                    </div>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4">
                    <div class="bg-gray-700/30 rounded-xl p-4">
                        <p class="text-sm text-gray-400">Website Users</p>
                        <p class="text-2xl font-bold text-white"><%= totalUsers %></p>
                    </div>
                    
                    <div class="bg-gray-700/30 rounded-xl p-4">
                        <p class="text-sm text-gray-400">Shot Users</p>
                        <p class="text-2xl font-bold text-white"><%= shotusersCount %></p>
                    </div>
                </div>
            </div>

            <!-- User Distribution -->
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50">
                <h3 class="text-lg font-semibold text-white mb-4">Staff Distribution</h3>
                <div class="relative h-48">
                    <canvas id="userDistributionChart"></canvas>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4">
                    <div class="bg-gray-700/30 rounded-xl p-4">
                        <p class="text-sm text-gray-400">Discord Roles</p>
                        <p class="text-2xl font-bold text-white"><%= discordStats.totalRoles %></p>
                    </div>
                    <div class="bg-gray-700/30 rounded-xl p-4">
                        <p class="text-sm text-gray-400">Discord Channels</p>
                        <p class="text-2xl font-bold text-white"><%= discordStats.totalChannels %></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Discord Server Stats -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- Server Boost -->
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-emerald-500/50 transition-all duration-300">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white">Discord Server Boost</h3>
                    <i class="ph ph-lightning text-2xl text-emerald-400"></i>
                </div>
                <p class="text-3xl font-bold text-white mb-2">Level <%= discordStats.boostLevel %></p>
                <p class="text-sm text-gray-400"><%= discordStats.boostCount %> Boosts</p>
            </div>

            <!-- Total Roles -->
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-emerald-500/50 transition-all duration-300">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white">Discord Total Roles</h3>
                    <i class="ph ph-users-three text-2xl text-emerald-400"></i>
                </div>
                <p class="text-3xl font-bold text-white mb-2"><%= discordStats.totalRoles %></p>
                <p class="text-sm text-gray-400">Server Roles</p>
            </div>

            <!-- Total Channels -->
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-emerald-500/50 transition-all duration-300">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white">Discord Total Channels</h3>
                    <i class="ph ph-hash text-2xl text-emerald-400"></i>
                </div>
                <p class="text-3xl font-bold text-white mb-2"><%= discordStats.totalChannels %></p>
                <p class="text-sm text-gray-400">Server Channels</p>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <!-- Total Tickets -->
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-emerald-500/50 transition-all duration-300">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white">Total Tickets</h3>
                    <i class="ph ph-ticket text-2xl text-emerald-400"></i>
                </div>
                <p class="text-3xl font-bold text-white mb-2"><%= totalTickets %></p>
                <p class="text-sm text-gray-400">All time ticket submissions</p>
            </div>

            <!-- Open Tickets -->
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-emerald-500/50 transition-all duration-300">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white">Open Tickets</h3>
                    <i class="ph ph-chat-circle-dots text-2xl text-emerald-400"></i>
                </div>
                <p class="text-3xl font-bold text-white mb-2"><%= openTickets %></p>
                <p class="text-sm text-gray-400">Currently active tickets</p>
            </div>

            <!-- Closed Tickets -->
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-emerald-500/50 transition-all duration-300">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white">Closed Tickets</h3>
                    <i class="ph ph-check-circle text-2xl text-emerald-400"></i>
                </div>
                <p class="text-3xl font-bold text-white mb-2"><%= closedTickets %></p>
                <p class="text-sm text-gray-400">Resolved tickets</p>
            </div>

            <!-- Website Users -->
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-emerald-500/50 transition-all duration-300">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white">Website Users</h3>
                    <i class="ph ph-users text-2xl text-emerald-400"></i>
                </div>
                <p class="text-3xl font-bold text-white mb-2"><%= totalUsers %></p>
                <p class="text-sm text-gray-400">Registered users</p>
            </div>
        </div>
        <!-- Quick Actions -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- View All Tickets -->
            <a href="/admin/tickets" class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-emerald-500/50 transition-all duration-300 group">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 rounded-xl bg-emerald-500/10 flex items-center justify-center group-hover:bg-emerald-500/20 transition-colors">
                        <i class="ph ph-ticket text-2xl text-emerald-400"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-white mb-1">View All Tickets</h3>
                        <p class="text-sm text-gray-400">Manage and respond to all support tickets</p>
                    </div>
                </div>
            </a>

            <!-- System Status to /status -->
            <a href="/status" class="bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-700/50 hover:border-emerald-500/50 transition-all duration-300 group">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 rounded-xl bg-emerald-500/10 flex items-center justify-center group-hover:bg-emerald-500/20 transition-colors">
                        <i class="ph ph-gauge text-2xl text-emerald-400"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-white mb-1">System Status</h3>
                        <p class="text-sm text-gray-400">All systems operational</p>
                    </div>
                </div>
            </a>
        </div>
    </main>

    <%- include('../partials/footer') %>
</body>

<script src="https://unpkg.com/@phosphor-icons/web"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // User Meter Chart (Half Circle)
    const userMeterCtx = document.getElementById('userMeterChart').getContext('2d');
    new Chart(userMeterCtx, {
        type: 'doughnut',
        data: {
            datasets: [{
                data: [<%= discordStats.totalMembers %>, 1000 - <%= discordStats.totalMembers %>],
                backgroundColor: [
                    '#10B981',
                    'rgba(31, 41, 55, 0.3)'
                ],
                borderWidth: 0,
                circumference: 180,
                rotation: 270
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '70%',
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    enabled: false
                }
            }
        }
    });

    // User Distribution Chart
    const userDistributionCtx = document.getElementById('userDistributionChart').getContext('2d');
    new Chart(userDistributionCtx, {
        type: 'doughnut',
        data: {
            labels: ['ꜰᴏᴜɴᴅᴇʀ', 'ᴄᴏᴍᴍᴜɴɪᴛʏ ᴍᴀɴᴀɢᴇʀ', 'ᴀᴅᴍɪɴ', 'ᴅᴇᴠ', 'Member'],
            datasets: [{
                data: [
                    <%= userDistribution.founder %>,
                    <%= userDistribution.communityManager %>,
                    <%= userDistribution.admin %>,
                    <%= userDistribution.dev %>,
                    <%= userDistribution.member %>
                ],
                backgroundColor: [
                    '#10B981',
                    '#3B82F6',
                    '#8B5CF6',
                    '#EC4899',
                    '#6B7280'
                ],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        color: '#9CA3AF',
                        padding: 20,
                        font: {
                            size: 12
                        }
                    }
                }
            }
        }
    });
</script> 